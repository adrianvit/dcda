<!DOCTYPE html>
<html>
<head>
<title>Servers Management</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link
	href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css"
	rel="stylesheet">
<script src="http://ajax.aspnetcdn.com/ajax/jquery/jquery-1.9.0.js"></script>
<script
	src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
<script src="http://ajax.aspnetcdn.com/ajax/knockout/knockout-2.2.1.js"></script>
<script src="products.js"></script>
<script src="objstorage.js"></script>
<script src="servers.js"></script>
</head>

<body>
<div class="container">
	
  	<div class="page-header">
 		 <h1>Servers Management</h1>
	</div>
	<div>
		<button class="btn btn-info" data-bind="click: $root.addServerButton">Add new Server</button>
	</div>
	<br>
	<div>
		<form class="form-search">
			<input  type="text" class="input-medium search-query" data-bind="visible: newServer, value: servName"></input>
			<input  type="text" class="input-medium search-query" data-bind="visible: newServer, value: servAddress"></input>
			<button class="btn btn btn-info" type="submit" data-bind="visible: newServer, click: $root.addServer">Add</button>
		</form>
	</div>
	<table class="table table-hover" >
		<thead>
			<tr>
				<th>Name</th>
				<th>Address</th>
				<th></th>
			</tr>
		</thead>
		<tbody data-bind="foreach: servers">
		<tr>
			<td data-bind="text: name"></td>
			<td data-bind="text: address"></td>
			<td><button class="btn btn-danger" data-bind="click: $root.removeServer">Remove</button></td>
		</tr>
		</tbody>
	</table>
	
<!-- <div>	
<ul class="pager">
	<li><a href="#" data-bind="click: previousPage, visible: pageIndex() > 0">Previous</a></li>
	<li><a href="#" data-bind="click: nextPage, visible: pageIndex() < 10">Next</a></li>
</ul>
</div> -->
</div>
	<script type="text/javascript">
		function ServerViewModel() {
			var self = this;

			self.newServer = ko.observable(false);
			self.servers = ko.observableArray([]);
			self.servName = ko.observable();
			self.servAddress = ko.observable();
			self.addServerButton = function() {
				self.newServer(true);
			};
			self.addServer = function() {
				self.servers.push(new Server(self.servName, self.servAddress));
				self.newServer(false);
			};

			self.removeServer = function(server){
				self.servers.remove(server);
			};
			/* self.pageSize = ko.observable(2);
			self.pageIndex = ko.observable(0);
			self.previousPage = function() {
				self.pageIndex(self.pageIndex() - 1);
			};
			self.nextPage = function() {
				self.pageIndex(self.pageIndex() + 1);
			};

			self.pagedRows = ko.dependentObservable(function() {
				var size = this.pageSize();
				var start = this.pageIndex() * size;
				return self.products.slice(start, start + size);
			}, self); */

			$.getJSON("http://localhost:18080/central/locate/", function(
					allData) {
				var mappedServers = $.map(allData, function(item) {
					return new Server(item.name, item.address)
				});
				self.servers(mappedServers);
			});
		};

		ko.applyBindings(new ServerViewModel());
	</script>
</body>
</html>
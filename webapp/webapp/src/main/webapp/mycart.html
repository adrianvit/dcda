<!DOCTYPE html>
<html>
<head>
<title>Shopping cart</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link
	href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css"
	rel="stylesheet">
<script src="http://ajax.aspnetcdn.com/ajax/jquery/jquery-1.9.0.js"></script>
<script
	src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
<script src="http://ajax.aspnetcdn.com/ajax/knockout/knockout-2.2.1.js"></script>
<script src="products.js"></script>
<script src="objstorage.js"></script>

</head>
<body>

<div class="container">
	<div class="page-header">
 		 <h1>My Shopping Cart</h1>
 	</div>
	<button class="btn btn-success" type="submit" data-bind="click: $root.goToProducts">Back to shopping</button>
	<br>
	<table class="table" >
		<thead>
			<tr>
				<th>Product ID</th>
				<th>Description</th>
				<th>Price</th>
				<th>Quantity</th>
				<th>Order</th>
			</tr>
		</thead>
		<tbody data-bind="foreach: $root.shoppingList">
		<tr>
			<td data-bind="text: product_id"></td>
			<td data-bind="text: description"></td>
			<td data-bind="text: price"></td>
			<td data-bind="value: myquantity"></td>
			<td><button class="btn btn-danger" data-bind="click: $root.remove">Remove from Cart</button></td>
			
		</tr>
		</tbody>
	</table>
	
	<h3 data-bind="visible: totalToPay() > 0">
        Total: <span data-bind="text: totalToPay().toFixed(2)"></span> RON
	</h3>
</div>

	<script type="text/javascript">

			function MyCartViewModel() {
				var self = this;
			
				self.myquantity = ko.observable(0);
				self.decoy = new Product("11","teeeef", "34", "44");
    			self.shoppingList = ko.observableArray([self.decoy]);
    			self.shoppingList.remove(self.decoy);
    			self.remove = function(product){
    				self.shoppingList.remove(product);
    			};
				self.goToProducts = function(){
					 // localStorage.setObj('products',self.shoppingList);
					  window.location.replace("http://localhost:18080/webapp/main.html");
    			};
    			self.totalToPay = ko.computed(function(){
    		        var total = 0;
    		        for(var i = 0; i < self.shoppingList().length; i++)
    		            total += self.shoppingList()[i].price * ;
    		        return total;
    		    });
    			self.shoppingList = localStorage.getObj('products');
			};
			ko.applyBindings(new MyCartViewModel());
	</script>
</body>
</html>
			
